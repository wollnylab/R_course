---
title: "Datenanalyse mit R / Data analysis with R - Exam"
date: '2023-02-09'
author: 'by Damian Wollny, Julia Micheel, Aram Safrastyan'
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, warning = FALSE, message = FALSE)
library(tidyverse)
```

## General Information

For following exam is build on the so-called `iris` data, which is is pre-installed in every R environment. You should be able to answer all questions without knowing the data. But in order to give you an idea what the data looks like, here are the first 5 rows:

```{r}
iris %>% head(5)
```

... and here is the structure of the data:

```{r}
str(iris)
```


## Question 1: Filtering dataframes

How was the data filtered to get the resulting dataframe (compare before vs. after)

**Before:**
```{r}
set.seed(234)
iris %>% 
  group_by(Species) %>% 
  sample_n(2) %>% 
  select(Petal.Width, Species) %>% 
  as.data.frame()
```
**After:**
```{r}
set.seed(234)
iris %>% 
  group_by(Species) %>% 
  sample_n(2) %>% 
  select(Petal.Width, Species) %>% 
  filter(Species != "setosa" & Petal.Width < 2) %>% 
  as.data.frame()
```

**Which answer is correct:**\

A.) `filter(Species != setosa & Petal.Width < 2)`\
B.) `filter(Species != "setosa" & Petal.Width < 2)`\
C.) `filter(Species != setosa | Petal.Width < 2)`\
D.) `filter(Species != "setosa" | Petal.Width < 2)`

--------------------------------------------------------------------------------------------------------

## Question 2: Plotting data - *Part1*

You want the plot you can see below using the following code:

**Code:**\

```{r, echo = TRUE, eval=F}
iris %>% # line 1
  ggplot(aes(x = Species, y = Sepal.Length, color = Species)) %>%  # line 2
  geom_boxplot() # line 3
```

**Plot:**\

```{r, fig.width=5, fig.height=3}
iris %>% 
  ggplot(aes(x = Species, y = Sepal.Length, color = Species)) +
  geom_boxplot() 
```

**Is the code correct?**\

A.) `code is correct`\
B.) `line 1 contains an error`\
C.) `line 2 contains an error`\
D.) `line 3 contains an error`\

--------------------------------------------------------------------------------------------------------

## Question 3: Plotting data - *Part2*

Which code will give you the plot you can see below:

**Plot:**\

```{r, fig.width=5, fig.height=3}
ggplot(data = iris, aes(x = Species, y = Petal.Length)) +
  geom_boxplot(aes(color = Species)) +
  geom_point()
```

**Which answer is correct:**\

A.) `ggplot(data = iris, mapping = aes(x = Species, y = Petal.Length)) + geom_boxplot(aes(color = Species)) + geom_point()`\
B.) `ggplot(data = iris, mapping = aes(x = Species, y = Petal.Length, color = Species)) + geom_boxplot() + geom_point()`\
C.) `ggplot(data = iris, mapping = aes(x = Species, y = Petal.Length)) + geom_boxplot() + geom_point(aes(color = Species))`\
D.) `ggplot(data = iris, mapping = aes(x = Species, y = Petal.Length), color = Species) + geom_boxplot() + geom_point()`\

--------------------------------------------------------------------------------------------------------

## Question 4: Summarize data

Which code will give you the table you can see below:

**Plot:**\

```{r, fig.width=5, fig.height=3}
iris %>% 
  group_by(Species) %>% 
  summarise(count = n(), ave_petal.width = mean(Petal.Width))
```

**Which answer is correct:**\

A.) `group_by(Petal.Width) %>% summarise(Species, count = n())`\
B.) `group_by(Species) %>% summarise(count = n(), ave_petal.width = mean(Petal.Width))`\
C.) `group_by(Species, Petal.Width) %>% summarise(ave_petal.width = mean(), count = n())`\
D.) `group_by(Species, mean(Petal.Width)) %>% summarise(count = n())`

--------------------------------------------------------------------------------------------------------

## Question 5: Regular expression (regex)

Which regular expression will filter the table correctly (compare before vs. after)

**Before:**
```{r}
iris %>% 
  count(Species) 
```
**After:**
```{r}
iris %>% 
  count(Species) %>% 
  filter(str_detect(Species, "o+"))
```

**Which answer is correct:**\

A.) `filter(str_detect(Species, "o{2}"))`\
B.) `filter(str_detect(Species, "o?"))`\
C.) `filter(str_detect(Species, "o*"))`\
D.) `filter(str_detect(Species, "o+"))`

--------------------------------------------------------------------------------------------------------

## Question 6: Tidy data

Which code, will get you the data in the desired format (compare before vs. after)

**Before:**
```{r}
wide <- iris %>% 
  head(1)
wide
```
**After:**
```{r}
wide %>% 
  pivot_longer(cols = !Species, names_to = "Attributes", values_to = "Value") %>% 
  as.data.frame()
```

**Which answer is correct:**\

A.) `pivot_longer(cols = !Species, names_to = "Value", values_to = "Attributes")`\
B.) `pivot_longer(cols = !Species, names_to = "Attributes", values_to = "Value")`\
C.) `pivot_wider(cols = !Species, names_to = "Value", values_to = "Attributes")`\
D.) `pivot_wider(cols = !Species, names_to = "Attributes", values_to = "Value")`

--------------------------------------------------------------------------------------------------------

## Question 7: Loading data

How do you specifiy the arguments of the read.csv() function in order to load the data that you can see below (Sepal.Length etc is supposed to be the header as shown in the *General Information*):

**Data before loading into R:**\

undesired line 1\
undesired line 2\
Sepal.Length,Sepal.Width,Petal.Length,Petal.Width,Species\
5.1,3.5,1.4,0.2,setosa\
4.9,3,1.4,0.2,setosa\
4.7,3.2,1.3,0.2,setosa\

**Which answer is correct:**\

A.) `skip = 2, header = T, sep = ","`\
B.) `skip = 2, header = F, sep = ","`\
C.) `skip = 3, header = F, sep = ","`\
D.) `skip = 2, header = T, sep = "."`

--------------------------------------------------------------------------------------------------------

## Question 8: Heatmaps

Which argument is <u>not part</u> of the code to create the heatmap shown below using the `pheatmap()`-function? 

```{r, fig.width= 10, fig.height=8,}
library(pheatmap)
iris_subsample <- iris %>%  group_by(Species) %>% dplyr::slice(1:20) %>% ungroup()

annotation_df <- iris_subsample %>% select(Species)
iris_subsample$Species <- NULL

iris_subsample <- as.data.frame(iris_subsample)
annotation_df <- as.data.frame(annotation_df)

rownames(iris_subsample) <- c(1:60)
rownames(annotation_df) <- c(1:60)
pheatmap(iris_subsample, annotation_row =  annotation_df, cluster_cols = F, angle_col = 315, cutree_rows = 4, gaps_col = 2)
```

**Which answer is correct:**\

A.) `annotation_row =  annotation_df`\
B.) `cluster_cols = F`\
C.) `gaps_col = 2`\
D.) `cluster_rows = F`

--------------------------------------------------------------------------------------------------------

## Question 9: Merging tables - *Part1*

How many <u>rows and columns</u> will the resulting dataframe have <u>after</u> merging the two dataframes **df1** and **df2** using the following code:

`left_join(df1, df2, by = "ID")`

**df1:**
```{r}
set.seed(123)
df1 <- iris %>% 
  select(Sepal.Length, Sepal.Width, Species) %>% 
  sample_n(3) %>% 
  mutate(ID = c(1:3))
df1
```
**df2:**
```{r}
set.seed(123)
df2 <- iris %>% 
  select(Petal.Length, Petal.Width, Species) %>% 
  sample_n(3) %>% 
  mutate(ID = c(2:4))
df2
```

**Which answer is correct:**\

A.) Columns: `4`; Rows: `3`\
B.) Columns: `4`; Rows: `6`\
C.) Columns: `5`; Rows: `3`\
D.) Columns: `6`; Rows: `3`\

--------------------------------------------------------------------------------------------------------

## Question 10: Merging tables - *Part2*

If you execute the code: `left_join(df1, df2, by = "ID")` on the dataframes **df1** and **df2** as described in Question 8, how many *NA* values will the resulting table have in total?

**Which answer is correct:**\

A.) `0`\
B.) `1`\
C.) `2`\
D.) `3`

--------------------------------------------------------------------------------------------------------

## Question 11: Modeling - *Part1*

Which line of code will <u>resolve</u> the following error which results when executing the command `cor(iris)`?

```{r, error=TRUE}
cor(iris)
```

**Which answer is correct:**\

A.) `iris %>% filter(Sepal.Width >= 3) %>% cor()`\
B.) `iris %>% select(-Species) %>% cor()`\
C.) `iris %>% mutate(width_sum = Sepal.Width + Petal.Width) %>% cor()`\
D.) `iris %>% select(-Sepal.Length) %>% cor()`

--------------------------------------------------------------------------------------------------------

## Question 12: Modeling - *Part2*

What <u>kind of model</u> is used here and which variable is the <u>dependent variable</u>?

```{r}
lm(Petal.Length ~ Petal.Width, data = iris) 
```

**Which answer is correct:**\

A.) logistic model; *Petal.Length* is the dependent variable\
B.) linear model; *Petal.Width* is the dependent variable\
C.) linear model; *Petal.Length* is the dependent variable\
D.) logistic model; *Petal.Width* is the dependent variable

--------------------------------------------------------------------------------------------------------